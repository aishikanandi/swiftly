"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[197],{4197:(Y,u,o)=>{o.r(u),o.d(u,{RunningrequestModule:()=>X});var a=o(177),t=o(7705),_=o(2758),l=o(5794),p=o(5351);function h(n,r){1&n&&(t.j41(0,"div",3),t.EFF(1," No records found "),t.k0s())}const d=function(n){return{"badge-success":n}};function v(n,r){if(1&n&&(t.j41(0,"span",20),t.EFF(1,"Accepted"),t.k0s()),2&n){const e=t.XpG().$implicit;t.Y8G("ngClass",t.eq3(1,d,4===e.ridestatus))}}function m(n,r){1&n&&t.nrm(0,"div",21)}function R(n,r){if(1&n&&(t.j41(0,"span",20),t.EFF(1,"Arrived"),t.k0s()),2&n){const e=t.XpG().$implicit;t.Y8G("ngClass",t.eq3(1,d,5===e.ridestatus))}}function f(n,r){if(1&n&&(t.j41(0,"span",20),t.EFF(1,"Picked"),t.k0s()),2&n){const e=t.XpG().$implicit;t.Y8G("ngClass",t.eq3(1,d,9===e.ridestatus))}}function b(n,r){if(1&n&&(t.j41(0,"span",20),t.EFF(1,"Started"),t.k0s()),2&n){const e=t.XpG().$implicit;t.Y8G("ngClass",t.eq3(1,d,6===e.ridestatus))}}function k(n,r){if(1&n&&(t.j41(0,"span",20),t.EFF(1,"Delivered"),t.k0s()),2&n){const e=t.XpG().$implicit;t.Y8G("ngClass",t.eq3(1,d,7===e.ridestatus))}}const F=function(n){return{"badge-warning":n}};function j(n,r){if(1&n&&(t.j41(0,"span",20),t.EFF(1,"Assigning"),t.k0s()),2&n){const e=t.XpG().$implicit;t.Y8G("ngClass",t.eq3(1,F,1===e.ridestatus))}}function C(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,c=t.XpG(2);return t.Njj(c.acceptRide(s))}),t.EFF(1,"Accept Ride"),t.k0s()}}function I(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,c=t.XpG(2);return t.Njj(c.arriveRide(s))}),t.EFF(1,"Arrive"),t.k0s()}}function D(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,c=t.XpG(2);return t.Njj(c.pickRide(s))}),t.EFF(1,"Pick Up"),t.k0s()}}function E(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,c=t.XpG(2);return t.Njj(c.startRide(s))}),t.EFF(1,"Start"),t.k0s()}}function q(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,c=t.XpG(2);return t.Njj(c.completeRide(s))}),t.EFF(1,"Deliver"),t.k0s()}}function G(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,c=t.XpG(2);return t.Njj(c.freerideanddriver(s))}),t.EFF(1,"Complete"),t.k0s()}}function x(n,r){if(1&n){const e=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(e);const s=t.XpG().$implicit,c=t.XpG(2);return t.Njj(c.rejectRide(s))}),t.EFF(1,"Reject Ride"),t.k0s()}}function $(n,r){if(1&n&&(t.j41(0,"tr")(1,"td"),t.nrm(2,"img",10),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td",11),t.EFF(14),t.k0s(),t.j41(15,"td",11),t.EFF(16),t.k0s(),t.j41(17,"td"),t.EFF(18),t.k0s(),t.j41(19,"td"),t.nrm(20,"img",12),t.k0s(),t.j41(21,"td",13),t.DNE(22,v,2,3,"span",14),t.DNE(23,m,1,0,"div",15),t.DNE(24,R,2,3,"span",14),t.DNE(25,f,2,3,"span",14),t.DNE(26,b,2,3,"span",14),t.DNE(27,k,2,3,"span",14),t.DNE(28,j,2,3,"span",16),t.k0s(),t.j41(29,"td",17),t.DNE(30,C,2,0,"button",18),t.DNE(31,I,2,0,"button",18),t.DNE(32,D,2,0,"button",18),t.DNE(33,E,2,0,"button",18),t.DNE(34,q,2,0,"button",18),t.DNE(35,G,2,0,"button",18),t.DNE(36,x,2,0,"button",19),t.k0s()()),2&n){const e=r.$implicit;t.R7$(4),t.JRh(e.userDetails.username),t.R7$(2),t.JRh(e.userDetails.userphone),t.R7$(2),t.JRh(e.driverDetails.drivername),t.R7$(2),t.JRh(e.driverDetails.driverphone),t.R7$(2),t.JRh(e.rideDate+" "+e.time),t.R7$(2),t.JRh(e.startLocation),t.R7$(2),t.JRh(e.endLocation),t.R7$(2),t.JRh(e.serviceType),t.R7$(2),t.FS9("src",e.vehicleDetails.vehicleImage,t.B4B),t.R7$(1),t.Y8G("ngSwitch",e.ridestatus),t.R7$(1),t.Y8G("ngSwitchCase",4),t.R7$(1),t.Y8G("ngIf",4===e.ridestatus||5===e.ridestatus||9===e.ridestatus||6===e.ridestatus),t.R7$(1),t.Y8G("ngSwitchCase",5),t.R7$(1),t.Y8G("ngSwitchCase",9),t.R7$(1),t.Y8G("ngSwitchCase",6),t.R7$(1),t.Y8G("ngSwitchCase",7),t.R7$(2),t.Y8G("ngSwitch",e.ridestatus),t.R7$(1),t.Y8G("ngSwitchCase",1),t.R7$(1),t.Y8G("ngSwitchCase",4),t.R7$(1),t.Y8G("ngSwitchCase",5),t.R7$(1),t.Y8G("ngSwitchCase",9),t.R7$(1),t.Y8G("ngSwitchCase",6),t.R7$(1),t.Y8G("ngSwitchCase",7),t.R7$(1),t.Y8G("ngIf",1===e.ridestatus)}}function w(n,r){if(1&n&&(t.j41(0,"div")(1,"div",4)(2,"div",5)(3,"div",6)(4,"table",7)(5,"thead",8)(6,"tr")(7,"th"),t.EFF(8,"User Profile"),t.k0s(),t.j41(9,"th"),t.EFF(10,"User Name"),t.k0s(),t.j41(11,"th"),t.EFF(12,"User Phone"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Driver Name"),t.k0s(),t.j41(15,"th"),t.EFF(16,"Driver Phone"),t.k0s(),t.j41(17,"th"),t.EFF(18,"Pick up Time"),t.k0s(),t.j41(19,"th"),t.EFF(20,"Pick up Address"),t.k0s(),t.j41(21,"th"),t.EFF(22,"Delivery Address"),t.k0s(),t.j41(23,"th"),t.EFF(24,"Service Type"),t.k0s(),t.j41(25,"th"),t.EFF(26,"Vehicle Image"),t.k0s(),t.j41(27,"th"),t.EFF(28,"Status"),t.k0s(),t.j41(29,"th"),t.EFF(30,"Action"),t.k0s()()(),t.j41(31,"tbody"),t.DNE(32,$,37,24,"tr",9),t.k0s()()()()()()),2&n){const e=t.XpG();t.R7$(32),t.Y8G("ngForOf",e.assignedArray)}}const g=function(){return[]};let T=(()=>{class n{constructor(e,i,s,c){this._socketservice=e,this.toastr=i,this._socket=s,this.dialog=c,this.driverData=JSON.parse(localStorage.getItem("userDetails")||"")}ngOnInit(){this.getRunningData(),this.assigneddriverfromAssignDialogBox(),this.afterrejectrunningrequest(),this.listenassignrejected(),this.ridestatusupates(),this.timeoutrunningreq(),this.listeningwhendriverisnearest(),this.listeningmytaskfunc(),this.listennearestassignbuttonclick()}getRunningData(){this._socketservice.emitRunningData(),this._socketservice.listenGetRunning().subscribe(e=>{this.assignedArray=e.alldata.filter(i=>i.driverDetails.driverphone===this.driverData.userphone),console.log(this.assignedArray)})}rejectRide(e){this.rideId=e._id,this.driverId=e.driverId,this.rejectRunningRequest(this.driverId,this.rideId)}rejectRunningRequest(e,i){console.log(i,e),this._socketservice.emitrejectRunningRequest({rideId:i,driverId:e}),this.getRunningData()}acceptRide(e){this.rideId=e._id,this.driverId=e.driverId,this.acceptrunningrequest(this.driverId,this.rideId)}arriveRide(e){this.rideId=e._id,this.arrivedrunningrequest(this.driverId,this.rideId)}pickRide(e){this.rideId=e._id,this.pickedrunningrequest(this.driverId,this.rideId)}startRide(e){this.rideId=e._id,this.startedrunningrequest(this.driverId,this.rideId)}completeRide(e){this.rideId=e._id,this.driverId=e.driverId,console.log(1),this.completedrunningrequest(this.driverId,this.rideId)}freerideanddriver(e){this.rideId=e._id,this.driverId=e.driverId,this.freerideanddriverrunningrequest(this.driverId,this.rideId)}acceptrunningrequest(e,i){this._socketservice.emitaccept({rideId:i,driverId:e}),this.getRunningData()}arrivedrunningrequest(e,i){this._socketservice.emitarrived({rideId:i,driverId:e}),this.getRunningData()}pickedrunningrequest(e,i){this._socketservice.emitpicked({rideId:i,driverId:e}),this.getRunningData()}startedrunningrequest(e,i){this._socketservice.emitstarted({rideId:i,driverId:e}),this.getRunningData()}completedrunningrequest(e,i){this._socketservice.emitcompleted({rideId:i,driverId:e}),console.log(2),this.getRunningData()}freerideanddriverrunningrequest(e,i){this._socketservice.emitfree({rideId:i,driverId:e}),this.getRunningData()}ridestatusupates(){this._socketservice.listeningrideupdates().subscribe(e=>{this.getRunningData()})}listenassignrejected(){this._socketservice.listenassignrejected().subscribe(e=>{this.getRunningData()})}afterrejectrunningrequest(){this._socketservice.listenrejectRunningRequest().subscribe(e=>{this.getRunningData()})}assigneddriverfromAssignDialogBox(){this._socketservice.onFinalassignedDriverData("data").subscribe(e=>{this.getRunningData()})}listennearestassignbuttonclick(){this._socketservice.listeningnearestdriver().subscribe(e=>{console.log(e),this.getRunningData()})}timeoutrunningreq(){this._socketservice.listeningrunningtimeoutinRR().subscribe(e=>{this.getRunningData()})}listeningmytaskfunc(){this._socket.listeningmytaskfunc().subscribe(e=>{this.getRunningData()})}listeningwhendriverisnearest(){this._socket.listeningwhendriverisnearest().subscribe(e=>{this.getRunningData()})}static{this.\u0275fac=function(i){return new(i||n)(t.rXU(_.L),t.rXU(l.tw),t.rXU(_.L),t.rXU(p.bZ))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-runningrequest"]],decls:3,vars:4,consts:[[1,"container"],["class","no-records-label",4,"ngIf"],[4,"ngIf"],[1,"no-records-label"],[1,"parentFormContainer","p-4","border","rounded"],["id","tableContainer"],[1,"table-responsive"],[1,"table"],[1,"bg-light","text-dark"],[4,"ngFor","ngForOf"],["src","http://localhost:4000/profile-1729178052737.png","alt","driver-profile"],[1,"fixed-width"],["alt","vehicle-image",3,"src"],[3,"ngSwitch"],["class","statusbadge",3,"ngClass",4,"ngSwitchCase"],["class","live-tracking-map",4,"ngIf"],["class","statusbadge",3,"ngClass",4,"ngSwitchDefault"],[1,"d-flex","gap-3",3,"ngSwitch"],["class","btn btn-light border",3,"click",4,"ngSwitchCase"],["class","btn btn-danger",3,"click",4,"ngIf"],[1,"statusbadge",3,"ngClass"],[1,"live-tracking-map"],[1,"btn","btn-light","border",3,"click"],[1,"btn","btn-danger",3,"click"]],template:function(i,s){1&i&&(t.j41(0,"div",0),t.DNE(1,h,2,0,"div",1),t.DNE(2,w,33,1,"div",2),t.k0s()),2&i&&(t.R7$(1),t.Y8G("ngIf",s.assignedArray===t.lJ4(2,g)),t.R7$(1),t.Y8G("ngIf",s.assignedArray!==t.lJ4(3,g)))},dependencies:[a.YU,a.Sq,a.bT,a.ux,a.e1,a.fG],styles:["img[_ngcontent-%COMP%]{width:40px}.fixed-width[_ngcontent-%COMP%]{width:100px}.container[_ngcontent-%COMP%]{width:100%}.map-container[_ngcontent-%COMP%]{width:100%;height:400px}.statusbadge[_ngcontent-%COMP%]{font-size:14px;padding:5px;border-radius:3px;font-weight:900}.badge-success[_ngcontent-%COMP%]{background-color:#49b600;color:#fff}.badge-info[_ngcontent-%COMP%]{background-color:#c200b8;color:#fff}.badge-warning[_ngcontent-%COMP%]{background-color:#e46600;color:#fff}.infobadge[_ngcontent-%COMP%]{box-shadow:inset 2px 2px 4px 2px #6d62fa;border:none;font-size:16px;color:#000;font-weight:700}.no-records-label[_ngcontent-%COMP%]{text-align:center;font-size:24px;font-weight:700;color:red;margin-top:20%}"]})}}return n})();var N=o(8498);const S=[{path:"",component:T,pathMatch:"full"}];let X=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[a.MD,N.iI.forChild(S)]})}}return n})()}}]);