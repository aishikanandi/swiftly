"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[701],{5701:(se,F,c)=>{c.r(F),c.d(F,{ConfirmrideModule:()=>ie});var p=c(177),d=c(5351);var e=c(7705),g=c(8834);function C(n,a){if(1&n&&(e.j41(0,"span",4),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.JRh(t.data.wayPoints)}}function k(n,a){1&n&&(e.j41(0,"span",4),e.EFF(1,"No way point"),e.k0s())}let v=(()=>{class n{constructor(t,s,i){this.dialog=t,this.dialogRef=s,this.data=i,this.dataArray=[],this.baseUrl="http://localhost:4000"}ngOnInit(){this.dataArray=this.data}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(d.bZ),e.rXU(d.CP),e.rXU(d.Vh))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-info-dialog"]],decls:83,vars:16,consts:[[1,"info-component"],[1,"ride-details-dialog"],[1,"ride-details","row","align-items-center"],[1,"details-key","col-sm-3","text-end"],[1,"details-value","col-sm-3","text-start"],["id","userimage"],["alt","user-profile",1,"details-key","col-sm-3","fit-image",3,"src"],["class","details-value col-sm-3 text-start",4,"ngIf","ngIfElse"],["noWayPoints",""],["id","serviceimage"],["alt","service-photo",1,"details-key","col-sm-3",3,"src"],["mat-dialog-actions",""],["mat-button","","mat-dialog-close","","cdkFocusInitial","",1,"info-button"]],template:function(s,i){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h2"),e.EFF(3,"Ride Details"),e.k0s(),e.j41(4,"div",2)(5,"span",3),e.EFF(6,"Request ID :"),e.k0s(),e.j41(7,"span",4),e.EFF(8),e.k0s()(),e.j41(9,"div",2)(10,"span",3),e.EFF(11,"User ID :"),e.k0s(),e.j41(12,"span",4),e.EFF(13),e.k0s()(),e.j41(14,"div",2)(15,"span",3),e.EFF(16,"User Name :"),e.k0s(),e.j41(17,"span",4),e.EFF(18),e.k0s()(),e.j41(19,"div",2)(20,"span",3),e.EFF(21,"User Profile :"),e.k0s(),e.j41(22,"div",5),e.nrm(23,"img",6),e.k0s()(),e.j41(24,"div",2)(25,"span",3),e.EFF(26,"User Email :"),e.k0s(),e.j41(27,"span",4),e.EFF(28),e.k0s()(),e.j41(29,"div",2)(30,"span",3),e.EFF(31,"User Phone :"),e.k0s(),e.j41(32,"span",4),e.EFF(33),e.k0s()(),e.j41(34,"div",2)(35,"span",3),e.EFF(36,"Pickup Location:"),e.k0s(),e.j41(37,"span",4),e.EFF(38),e.k0s()(),e.j41(39,"div",2)(40,"span",3),e.EFF(41,"Drop-off Location:"),e.k0s(),e.j41(42,"span",4),e.EFF(43),e.k0s()(),e.j41(44,"div",2)(45,"span",3),e.EFF(46,"Way Point :"),e.k0s(),e.DNE(47,C,2,1,"span",7),e.DNE(48,k,2,0,"ng-template",null,8,e.C5r),e.k0s(),e.j41(50,"div",2)(51,"span",3),e.EFF(52,"Service Type :"),e.k0s(),e.j41(53,"span",4),e.EFF(54),e.k0s()(),e.j41(55,"div",2)(56,"span",3),e.EFF(57,"Service Image :"),e.k0s(),e.j41(58,"div",9),e.nrm(59,"img",10),e.k0s()(),e.j41(60,"div",2)(61,"span",3),e.EFF(62,"Total Distance :"),e.k0s(),e.j41(63,"span",4),e.EFF(64),e.k0s()(),e.j41(65,"div",2)(66,"span",3),e.EFF(67,"Estimatetd Time :"),e.k0s(),e.j41(68,"span",4),e.EFF(69),e.k0s()(),e.j41(70,"div",2)(71,"span",3),e.EFF(72,"Estimated Fare :"),e.k0s(),e.j41(73,"span",4),e.EFF(74),e.k0s()(),e.j41(75,"div",2)(76,"span",3),e.EFF(77,"Booking Time :"),e.k0s(),e.j41(78,"span",4),e.EFF(79),e.k0s()()(),e.j41(80,"div",11)(81,"button",12),e.EFF(82,"Ok"),e.k0s()()()),2&s){const r=e.sdS(49);e.R7$(8),e.JRh(i.data._id),e.R7$(5),e.JRh(i.data.userId),e.R7$(5),e.JRh(i.data.userDetails.username),e.R7$(5),e.Mz_("src","http://localhost:4000/",i.data.userDetails.profile,"",e.B4B),e.R7$(5),e.JRh(i.data.userDetails.useremail),e.R7$(5),e.JRh(i.data.userDetails.countrycode+" "+i.data.userDetails.userphone),e.R7$(5),e.JRh(i.data.startLocation),e.R7$(5),e.JRh(i.data.endLocation),e.R7$(4),e.Y8G("ngIf",i.data.wayPoints&&i.data.wayPoints.length>0)("ngIfElse",r),e.R7$(7),e.JRh(i.data.serviceType),e.R7$(5),e.FS9("src",i.data.vehicleDetails.vehicleImage,e.B4B),e.R7$(5),e.JRh(i.data.totalDistance),e.R7$(5),e.JRh(i.data.estimateTime),e.R7$(5),e.SpI("\u20b9 ",i.data.estimateFare,""),e.R7$(5),e.JRh(i.data.updatedAt)}},dependencies:[p.bT,g.$z,d.tx,d.E7],styles:[".info-component[_ngcontent-%COMP%]{overflow:hidden}.ride-details-dialog[_ngcontent-%COMP%]{text-align:center}.ride-details[_ngcontent-%COMP%]{margin-bottom:10px}.details-key[_ngcontent-%COMP%]{font-weight:700;white-space:nowrap}.details-value[_ngcontent-%COMP%]{white-space:nowrap}.info-button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;border:none;border-radius:4px;background-color:#830fff;color:#fff;cursor:pointer}.fit-image[_ngcontent-%COMP%]{max-width:100px;max-height:100px;border-radius:50%}@media (max-width: 767px){.ride-details-dialog[_ngcontent-%COMP%]{padding:20px}}"]})}}return n})();var b=c(2758),j=c(2709);function E(n,a){if(1&n&&(e.j41(0,"span",8),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(": ",t.data.wayPoints,"")}}function R(n,a){1&n&&(e.j41(0,"span",8),e.EFF(1,": No way point"),e.k0s())}let D=(()=>{class n{constructor(t,s,i,r,o){this.dialog=t,this.dialogRef=s,this.data=i,this._socketService=r,this._runningRequestService=o,this.baseUrl="http://localhost:4000",this.dataArray=[],this.driverArray=[]}ngOnInit(){this.getDriverData(),this.assigndriverdata(),this.gettingrejectrunningrequestdata(),this.listenassignrejected(),this.dataArray=this.data}getDriverData(){this.cityId=this.data.cityId,this.serviceId=this.data.serviceId,this._socketService.getAssignedDriverData(this.cityId,this.serviceId),this._socketService.onUpdateStatusData().subscribe({next:t=>{console.log(t),this._socketService.getAssignedDriverData(this.cityId,this.serviceId),this._socketService.onAssignedDriverData().subscribe(s=>{console.log(s),s?(this.driverArray=s,console.log(this.driverArray)):console.log("Error retrieving assigned driver data:",s)})}}),this._socketService.onAssignedDriverData().subscribe(t=>{t?(this.driverArray=t,this.driver=t):console.log("Error retrieving assigned driver data:",t)}),this._socketService.onUpdateServiceData().subscribe({next:t=>{this._socketService.getAssignedDriverData(this.cityId,this.serviceId),t?this.driverArray=t:console.log("Error retrieving assigned driver data:",t)}})}assigndriverdata(){this._socketService.onFinalassignedDriverData("data").subscribe({next:t=>{this._socketService.getAssignedDriverData(this.cityId,this.serviceId),this._socketService.onAssignedDriverData().subscribe(s=>{this.driverArray=s})}})}assignDriver(t){this.dialogRef.close({ridedata:this.data,driverdata:t})}NearestDriver(t){this.data.nearest=!0,this.dialogRef.close({ridedata:this.data,driverdata:t})}listenassignrejected(){this._socketService.listenassignrejected().subscribe(t=>{this.getDriverData()})}gettingrejectrunningrequestdata(){this._socketService.listenrejectRunningRequest().subscribe(t=>{this.getDriverData()})}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(d.bZ),e.rXU(d.CP),e.rXU(d.Vh),e.rXU(b.L),e.rXU(j.c))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-assign-driver"]],decls:78,vars:14,consts:[[1,"container","p-4"],[1,"parentFormContainer"],["id","tableContainer"],[1,"info-component"],[1,"ride-details-dialog"],[1,"text-start"],[1,"ride-details","row","align-items-center"],[1,"details-key","col-sm-3","text-start"],[1,"details-value","col-sm-3","text-start"],["class","details-value col-sm-3 text-start",4,"ngIf","ngIfElse"],["noWayPoints",""],["mat-dialog-actions",""],["mat-button","","mat-dialog-close","","cdkFocusInitial","",1,"info-button"],["mat-button","","mat-dialog-close","","cdkFocusInitial","",1,"info-button","nearest-driver-button",3,"click"]],template:function(s,i){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),e.EFF(6,"Ride Details"),e.k0s(),e.j41(7,"div",6)(8,"span",7),e.EFF(9,"Request ID"),e.k0s(),e.j41(10,"span",8),e.EFF(11),e.k0s()(),e.j41(12,"div",6)(13,"span",7),e.EFF(14,"User ID "),e.k0s(),e.j41(15,"span",8),e.EFF(16),e.k0s()(),e.j41(17,"div",6)(18,"span",7),e.EFF(19,"User Name "),e.k0s(),e.j41(20,"span",8),e.EFF(21),e.k0s()(),e.j41(22,"div",6)(23,"span",7),e.EFF(24,"User Email "),e.k0s(),e.j41(25,"span",8),e.EFF(26),e.k0s()(),e.j41(27,"div",6)(28,"span",7),e.EFF(29,"User Phone "),e.k0s(),e.j41(30,"span",8),e.EFF(31),e.k0s()(),e.j41(32,"div",6)(33,"span",7),e.EFF(34,"Pickup Location"),e.k0s(),e.j41(35,"span",8),e.EFF(36),e.k0s()(),e.j41(37,"div",6)(38,"span",7),e.EFF(39,"Drop-off Location"),e.k0s(),e.j41(40,"span",8),e.EFF(41),e.k0s()(),e.j41(42,"div",6)(43,"span",7),e.EFF(44,"Way Point "),e.k0s(),e.DNE(45,E,2,1,"span",9),e.DNE(46,R,2,0,"ng-template",null,10,e.C5r),e.k0s(),e.j41(48,"div",6)(49,"span",7),e.EFF(50,"Service Type "),e.k0s(),e.j41(51,"span",8),e.EFF(52),e.k0s()(),e.j41(53,"div",6)(54,"span",7),e.EFF(55,"Total Distance "),e.k0s(),e.j41(56,"span",8),e.EFF(57),e.k0s()(),e.j41(58,"div",6)(59,"span",7),e.EFF(60,"Estimated Time "),e.k0s(),e.j41(61,"span",8),e.EFF(62),e.k0s()(),e.j41(63,"div",6)(64,"span",7),e.EFF(65,"Estimated Fare "),e.k0s(),e.j41(66,"span",8),e.EFF(67),e.k0s()(),e.j41(68,"div",6)(69,"span",7),e.EFF(70,"Booking Time "),e.k0s(),e.j41(71,"span",8),e.EFF(72),e.k0s()()(),e.j41(73,"div",11)(74,"button",12),e.EFF(75,"Cancel"),e.k0s(),e.j41(76,"button",13),e.bIt("click",function(){return i.NearestDriver(i.driver)}),e.EFF(77,"Nearest Driver"),e.k0s()()()()()()),2&s){const r=e.sdS(47);e.R7$(11),e.SpI(": ",i.data._id,""),e.R7$(5),e.SpI(": ",i.data.userId,""),e.R7$(5),e.SpI(": ",i.data.userDetails.username,""),e.R7$(5),e.SpI(": ",i.data.userDetails.useremail,""),e.R7$(5),e.SpI(": ",i.data.userDetails.countrycode+" "+i.data.userDetails.userphone,""),e.R7$(5),e.SpI(": ",i.data.startLocation,""),e.R7$(5),e.SpI(": ",i.data.endLocation,""),e.R7$(4),e.Y8G("ngIf",i.data.wayPoints&&i.data.wayPoints.length>0)("ngIfElse",r),e.R7$(7),e.SpI(": ",i.data.serviceType,""),e.R7$(5),e.SpI(": ",i.data.totalDistance,""),e.R7$(5),e.SpI(": ",i.data.estimateTime,""),e.R7$(5),e.SpI(": \u20b9 ",i.data.estimateFare,""),e.R7$(5),e.SpI(": ",i.data.updatedAt,"")}},dependencies:[p.bT,g.$z,d.tx,d.E7],styles:["img[_ngcontent-%COMP%]{width:40px}.info-component[_ngcontent-%COMP%]{overflow:hidden}.ride-details-dialog[_ngcontent-%COMP%]{text-align:center}.ride-details[_ngcontent-%COMP%]{margin-bottom:10px}.details-key[_ngcontent-%COMP%]{font-weight:700;white-space:nowrap}.details-value[_ngcontent-%COMP%]{white-space:nowrap}.info-button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;font-weight:700;border:none;border-radius:4px;background-color:#ff0f0f;color:#fff;cursor:pointer}.nearest-driver-button[_ngcontent-%COMP%]{background-color:green;color:#fff}@media (max-width: 767px){.ride-details-dialog[_ngcontent-%COMP%]{padding:20px}}"]})}}return n})();var l=c(9417),x=c(1626),m=c(9213);const P=function(n){return{rated:n}};function M(n,a){if(1&n){const t=e.RV6();e.j41(0,"mat-icon",28),e.bIt("click",function(){const r=e.eBV(t).index,o=e.XpG();return e.Njj(o.setRating(r+1))}),e.EFF(1," star "),e.k0s()}if(2&n){const t=a.index,s=e.XpG();e.Y8G("ngClass",e.eq3(1,P,t<s.rating))}}let y=(()=>{class n{constructor(t,s,i,r,o){this.dialog=t,this.dialogRef=s,this.data=i,this.formBuilder=r,this.http=o,this.serverUrl="http://localhost:4000",this.rating=0,this.rideId="",this.starsArray=[!0,!0,!0,!0,!0],this.feedbackForm=this.formBuilder.group({name:"",email:"",phone:"",message:""})}ngOnInit(){}submitForm(){const s={formData:this.feedbackForm.value,rideId:this.data.rideId,rating:this.rating};console.log(s),this.http.post(`${this.serverUrl}/feedback`,s).subscribe(i=>{console.log("Backend Response:",i)})}setRating(t){this.rating=t}resetForm(){this.feedbackForm.reset(),this.rating=0}closeDialog(){this.dialogRef.close()}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(d.bZ),e.rXU(d.CP),e.rXU(d.Vh),e.rXU(l.ok),e.rXU(x.Qq))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-feedback"]],decls:42,vars:2,consts:[[1,"screen"],[1,"screen-header"],[1,"screen-header-left"],[1,"screen-header-button","close"],[1,"screen-header-button","maximize"],[1,"screen-header-button","minimize"],[1,"screen-header-right"],[1,"screen-header-ellipsis"],[1,"screen-body"],[1,"screen-body-item","left"],[1,"app-title"],[1,"mb-3"],[1,"app-contact"],[1,"screen-body-item"],[1,"app-form"],[3,"formGroup","ngSubmit"],[1,"app-form-group"],["placeholder","YOUR NAME","formControlName","name",1,"app-form-control"],["placeholder","YOUR EMAIL","formControlName","email",1,"app-form-control"],["maxlength","10","placeholder","CONTACT NO","formControlName","phone",1,"app-form-control"],["for","rating",1,"rating-label"],[1,"rating"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"app-form-group","message"],["placeholder","YOUR FEEDBACK (Optional)","formControlName","message",1,"app-form-control"],[1,"app-form-group","buttons"],["type","button","mat-dialog-close","",1,"app-form-button",3,"click"],["type","submit","mat-button","","mat-dialog-close","","cdkFocusInitial","",1,"app-form-button","info-button"],[3,"ngClass","click"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.nrm(3,"div",3)(4,"div",4)(5,"div",5),e.k0s(),e.j41(6,"div",6),e.nrm(7,"div",7)(8,"div",7)(9,"div",7),e.k0s()(),e.j41(10,"div",8)(11,"div",9)(12,"div",10)(13,"span",11),e.EFF(14,"ORDER"),e.k0s(),e.j41(15,"span"),e.EFF(16,"FEEDBACK"),e.k0s()(),e.j41(17,"div",12),e.EFF(18,"Order Info: Order #12345"),e.k0s(),e.j41(19,"div",12),e.EFF(20,"Contact Info: +62 81 314 928 595"),e.k0s()(),e.j41(21,"div",13)(22,"div",14)(23,"form",15),e.bIt("ngSubmit",function(){return i.submitForm()}),e.j41(24,"div",16),e.nrm(25,"input",17),e.k0s(),e.j41(26,"div",16),e.nrm(27,"input",18),e.k0s(),e.j41(28,"div",16),e.nrm(29,"input",19),e.k0s(),e.j41(30,"div",16)(31,"label",20),e.EFF(32,"Rate your Order:"),e.k0s(),e.j41(33,"div",21),e.DNE(34,M,2,3,"mat-icon",22),e.k0s()(),e.j41(35,"div",23),e.nrm(36,"textarea",24),e.k0s(),e.j41(37,"div",25)(38,"button",26),e.bIt("click",function(){return i.resetForm()}),e.EFF(39,"CANCEL"),e.k0s(),e.j41(40,"button",27),e.EFF(41,"SEND FEEDBACK"),e.k0s()()()()()()()),2&s&&(e.R7$(23),e.Y8G("formGroup",i.feedbackForm),e.R7$(11),e.Y8G("ngForOf",i.starsArray))},dependencies:[p.YU,p.Sq,l.qT,l.me,l.BC,l.cb,l.tU,l.j4,l.JD,m.An,g.$z,d.tx],styles:[".background[_ngcontent-%COMP%]{background:#f4f7f6;display:flex;align-items:center;justify-content:center}.container[_ngcontent-%COMP%]{width:100%;max-width:800px}.screen[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a;overflow:hidden}.screen-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid #e0e0e0}.screen-header-left[_ngcontent-%COMP%], .screen-header-right[_ngcontent-%COMP%]{display:flex;align-items:center}.screen-header-button[_ngcontent-%COMP%]{width:12px;height:12px;margin:0 4px;border-radius:50%;background-color:#ccc}.screen-header-button.close[_ngcontent-%COMP%]{background-color:#e57373}.screen-header-button.maximize[_ngcontent-%COMP%]{background-color:#81c784}.screen-header-button.minimize[_ngcontent-%COMP%]{background-color:#ffeb3b}.screen-header-ellipsis[_ngcontent-%COMP%]{width:5px;height:5px;margin:0 2px;border-radius:50%;background-color:#bdbdbd}.screen-body[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:20px 0}.screen-body-item[_ngcontent-%COMP%]{flex:1}.app-title[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#333}.app-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.app-contact[_ngcontent-%COMP%]{margin-top:20px;font-size:14px;color:#777}.app-form[_ngcontent-%COMP%]{background:#f9f9f9;padding:20px;border-radius:8px;box-shadow:0 2px 4px #0000001a}.app-form-control[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;color:#333}.app-form-control[_ngcontent-%COMP%]:focus{border-color:#5c9ded;outline:none}.app-form-group.message[_ngcontent-%COMP%]{margin-bottom:20px}.app-form-control.message[_ngcontent-%COMP%]{height:100px;padding:10px}.app-form-button[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:14px}.app-form-button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.app-form-button.info-button[_ngcontent-%COMP%]{background-color:#007bff}.app-form-group.buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.app-form-button.cancel[_ngcontent-%COMP%]{background-color:#f44336}.rating[_ngcontent-%COMP%]{display:flex;justify-content:space-around;width:150px;margin-bottom:15px}.rating[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:24px;cursor:pointer;color:#ddd}.rating[_ngcontent-%COMP%]   .rated[_ngcontent-%COMP%]{color:gold}.rating[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]:hover{color:#ffeb3b}.rating-label[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#555;margin-bottom:10px;display:block}.app-form-group[_ngcontent-%COMP%]{margin-bottom:20px}.app-form-button[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer}.app-form-button[_ngcontent-%COMP%]:disabled{background-color:#ccc}.app-form-group.message[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;height:120px;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;resize:none}"]})}}return n})();var I=c(6731),O=c(3037),$=c(4131),f=c(415),h=c(9115);function S(n,a){if(1&n&&(e.j41(0,"option",4),e.EFF(1),e.k0s()),2&n){const t=a.$implicit;e.Y8G("value",t),e.R7$(1),e.JRh(t)}}const w=function(n){return{"badge-info":n}};function T(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Requested"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,w,1===t.ridestatus))}}const G=function(n){return{"badge-danger":n}};function A(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Rejected"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,G,2===t.ridestatus))}}const u=function(n){return{"badge-success":n}};function U(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Accepted"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,u,4===t.ridestatus))}}function Y(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Arrived"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,u,5===t.ridestatus))}}function N(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Picked"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,u,9===t.ridestatus))}}function X(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Started"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,u,6===t.ridestatus))}}function z(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Delivered"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,u,7===t.ridestatus))}}const B=function(n){return{"badge-light":n}};function V(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Hold"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,B,8===t.ridestatus))}}const J=function(n){return{"badge-warning":n}};function L(n,a){if(1&n&&(e.j41(0,"span",37),e.EFF(1,"Pending"),e.k0s()),2&n){const t=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,J,0===t.ridestatus))}}function q(n,a){if(1&n&&(e.j41(0,"button",38),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.JRh(t.driverDetails.drivername)}}function K(n,a){if(1&n){const t=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,r=e.XpG();return e.Njj(r.openAssignDriverDialog(i))}),e.EFF(1,"Search Driver"),e.k0s()}}function W(n,a){if(1&n){const t=e.RV6();e.j41(0,"button",35),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,r=e.XpG();return e.Njj(r.cancelride(i._id))}),e.j41(1,"mat-icon"),e.EFF(2,"delete"),e.k0s(),e.EFF(3,"Cancel Ride"),e.k0s()}}function Z(n,a){if(1&n){const t=e.RV6();e.j41(0,"button",35),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,r=e.XpG();return e.Njj(r.openFeedbackDialog(i._id))}),e.j41(1,"mat-icon"),e.EFF(2,"star"),e.k0s(),e.EFF(3,"Rate driver"),e.k0s()}}function H(n,a){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",27),e.EFF(6),e.k0s(),e.j41(7,"td",27),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td",28),e.DNE(12,T,2,3,"span",29),e.DNE(13,A,2,3,"span",29),e.DNE(14,U,2,3,"span",29),e.DNE(15,Y,2,3,"span",29),e.DNE(16,N,2,3,"span",29),e.DNE(17,X,2,3,"span",29),e.DNE(18,z,2,3,"span",29),e.DNE(19,V,2,3,"span",29),e.DNE(20,L,2,3,"span",30),e.k0s(),e.j41(21,"td"),e.DNE(22,q,2,1,"button",31),e.DNE(23,K,2,0,"button",32),e.k0s(),e.j41(24,"td")(25,"button",33)(26,"mat-icon"),e.EFF(27,"edit"),e.k0s()(),e.j41(28,"mat-menu",null,34)(30,"button",35),e.bIt("click",function(){const r=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.openInfoDialog(r))}),e.j41(31,"mat-icon"),e.EFF(32,"info"),e.k0s(),e.EFF(33,"Ride Info"),e.k0s(),e.DNE(34,W,4,0,"button",36),e.DNE(35,Z,4,0,"button",36),e.k0s()()()}if(2&n){const t=a.$implicit,s=e.sdS(29);e.R7$(2),e.JRh(t._id),e.R7$(2),e.JRh(t.rideDate),e.R7$(2),e.JRh(t.startLocation),e.R7$(2),e.JRh(t.endLocation),e.R7$(2),e.JRh(t.serviceType),e.R7$(1),e.Y8G("ngSwitch",t.ridestatus),e.R7$(1),e.Y8G("ngSwitchCase",1),e.R7$(1),e.Y8G("ngSwitchCase",2),e.R7$(1),e.Y8G("ngSwitchCase",4),e.R7$(1),e.Y8G("ngSwitchCase",5),e.R7$(1),e.Y8G("ngSwitchCase",9),e.R7$(1),e.Y8G("ngSwitchCase",6),e.R7$(1),e.Y8G("ngSwitchCase",7),e.R7$(1),e.Y8G("ngSwitchCase",8),e.R7$(3),e.Y8G("ngIf",t.driverDetails),e.R7$(1),e.Y8G("ngIf",0===t.ridestatus||8===t.ridestatus),e.R7$(2),e.Y8G("matMenuTriggerFor",s),e.R7$(9),e.Y8G("ngIf",1===t.ridestatus||2===t.ridestatus||8===t.ridestatus||4===t.ridestatus),e.R7$(1),e.Y8G("ngIf",7===t.ridestatus)}}const Q=function(n,a,t){return{itemsPerPage:n,currentPage:a,totalItems:t}};let ee=(()=>{class n{constructor(t,s,i,r,o){this.authService=t,this._confirmride=s,this.dialog=i,this._socket=r,this._vehicleservice=o,this.ridesArray=[],this.limit=20,this.currentPage=1,this.totalPages=0,this.search="",this.paginatedRideData=[],this.driverArray=[],this.statusfilter=-1,this.vehiclefilter="",this.filteredVehicles=[],this.sortOrder="desc",this.userid=JSON.parse(localStorage.getItem("userDetails")||"")._id}ngOnInit(){this.getrideData(),this.getVehicle(),this.gettingstatusafterassigninCFR(),this.gettingstatusafterrejectinCFR(),this.listeningtimeoutstatusinCFR(),this.listeningwhendriverisnearest(),this.listenassignrejected(),this.listennearestassignbuttonclick(),this.ridestatusupates()}getrideData(){this.search=this.searchText||this.searchDate,console.log(this.userid),this._confirmride.getride(this.currentPage,this.limit,this.search,this.vehiclefilter,this.sortOrder,this.userid).subscribe({next:t=>{this.ridesArray=t.rides,console.log(this.ridesArray),this.totalPages=t.totalPages,this.count=t.totalCount},error:t=>{console.log(t)}})}onPageSizeChange(t){this.limit=parseInt(t.target.value),console.log(this.limit),this.currentPage=1,this.updatePaginatedDrivers(),this.getrideData()}onPageChange(t){console.log(t),t>=1&&t<=this.totalPages&&(this.currentPage=t,this.updatePaginatedDrivers(),this.getrideData())}updatePaginatedDrivers(){const t=(this.currentPage-1)*this.limit;this.paginatedRideData=this.ridesArray.slice(t,t+this.limit)}getVehicle(){this._vehicleservice.getvehicleData().subscribe(t=>{this.filteredVehicles=t.data.map(s=>s.vehicleName)})}clearFilter(){this.statusfilter=-1,this.vehiclefilter="",this.sortOrder="asc",this.getrideData()}openInfoDialog(t){const s=new d.ru;s.disableClose=!1,s.autoFocus=!0,s.width="650px",s.data=t,this.dialog.open(v,s)}openAssignDriverDialog(t){const s=new d.ru;s.disableClose=!1,s.autoFocus=!0,s.width="1000px",s.data=t,this.dialog.open(D,s).afterClosed().subscribe(r=>{console.log(r),this.driverdataArray=r,this.driverId=this.driverdataArray.driverdata._id,this.rideId=this.driverdataArray.ridedata._id,this.cityId=this.driverdataArray.ridedata.cityId,this.serviceId=this.driverdataArray.ridedata.serviceId,0==this.driverdataArray.ridedata.nearest?this._socket.emitassignedDriver(this.driverId,this.rideId):(this._socket.emitnearestdriver(this.rideId,this.cityId,this.serviceId),this._socket.listeningmytaskfunc().subscribe(o=>{this.getrideData()}))})}gettingstatusafterassigninCFR(){this._socket.onFinalassignedDriverData("data").subscribe(t=>{this.getrideData()})}listenassignrejected(){this._socket.listenassignrejected().subscribe(t=>{this.getrideData()})}gettingstatusafterrejectinCFR(){this._socket.listenrejectRunningRequest().subscribe(t=>{this.getrideData()})}listeningtimeoutstatusinCFR(){this._socket.listeningtimeoutstatusinCFR().subscribe(t=>{this.getrideData()})}listeningwhendriverisnearest(){this._socket.listeningwhendriverisnearest().subscribe(t=>{this.getrideData()})}listennearestassignbuttonclick(){this._socket.listeningnearestdriver().subscribe(t=>{this.getrideData()})}ridestatusupates(){this._socket.listeningrideupdates().subscribe(t=>{this.getrideData(),7===t.ridestatus&&this.openFeedbackDialog(t._id)})}openFeedbackDialog(t){const s=new d.ru;s.disableClose=!1,s.autoFocus=!0,s.width="650px",s.data={rideId:t},console.log(s.data),this.dialog.open(y,s).afterClosed().subscribe(r=>{console.log("Dialog closed with result:",r)})}cancelride(t){this._socket.emitcancelride(t),this.ridesArray=this.ridesArray.filter(s=>s._id!==t),this._socket.listencancelride().subscribe(s=>{this.getrideData()})}resetTimer(){this.authService.resetInactivityTimer()}static{this.\u0275fac=function(s){return new(s||n)(e.rXU(I.u),e.rXU(O.K),e.rXU(d.bZ),e.rXU(b.L),e.rXU($.K))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-confirmride"]],decls:75,vars:20,consts:[[1,"container"],[1,"filter-section"],["id","filter-dropdown",3,"ngModel","ngModelChange"],["value","-1"],[3,"value"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","text","id","search-input","placeholder","Search by Req. ID, Name, Phone, Pick up Date...",3,"ngModel","ngModelChange"],["type","date","id","search-input",3,"ngModel","ngModelChange"],["id","searchbtn",3,"click"],[1,"custom-select"],["id","pageSize",1,"m-2",3,"ngModel","ngModelChange","change"],["value","20"],["value","50"],["value","100"],["value","desc"],["value","asc"],["id","filterbtn",3,"click"],["id","clearbtn",3,"click"],[1,"parentFormContainer"],["id","tableContainer"],[1,"table-responsive"],[1,"table"],[1,"text-dark"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center"],[3,"maxSize","responsive","pageChange"],[1,"fixed-width"],[3,"ngSwitch"],["class","statusbadge",3,"ngClass",4,"ngSwitchCase"],["class","statusbadge",3,"ngClass",4,"ngSwitchDefault"],["class","btn btn-success",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],["color","accent","mat-button","",3,"matMenuTriggerFor"],["lvl2master","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"statusbadge",3,"ngClass"],[1,"btn","btn-success"],[1,"btn","btn-primary",3,"click"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"select",2),e.bIt("ngModelChange",function(o){return i.statusfilter=o}),e.j41(3,"option",3),e.EFF(4,"Select Status"),e.k0s(),e.j41(5,"option",4),e.EFF(6,"Pending"),e.k0s(),e.j41(7,"option",4),e.EFF(8,"Assigning"),e.k0s(),e.j41(9,"option",4),e.EFF(10,"Rejected"),e.k0s()(),e.j41(11,"select",2),e.bIt("ngModelChange",function(o){return i.vehiclefilter=o}),e.j41(12,"option",5),e.EFF(13,"Select a vehicle"),e.k0s(),e.DNE(14,S,2,2,"option",6),e.k0s(),e.j41(15,"input",7),e.bIt("ngModelChange",function(o){return i.searchText=o}),e.k0s(),e.j41(16,"input",8),e.bIt("ngModelChange",function(o){return i.searchDate=o}),e.k0s(),e.j41(17,"button",9),e.bIt("click",function(){return i.getrideData()}),e.EFF(18,"Search"),e.k0s(),e.j41(19,"div",10)(20,"select",11),e.bIt("ngModelChange",function(o){return i.limit=o})("change",function(o){return i.onPageSizeChange(o)}),e.j41(21,"option",12),e.EFF(22,"Select Page"),e.k0s(),e.j41(23,"option",12),e.EFF(24,"20"),e.k0s(),e.j41(25,"option",13),e.EFF(26,"50"),e.k0s(),e.j41(27,"option",14),e.EFF(28,"100"),e.k0s()()(),e.j41(29,"select",2),e.bIt("ngModelChange",function(o){return i.sortOrder=o}),e.j41(30,"option",15),e.EFF(31,"Sorting Order"),e.k0s(),e.j41(32,"option",16),e.EFF(33,"Ascending"),e.k0s(),e.j41(34,"option",15),e.EFF(35,"Descending"),e.k0s()(),e.j41(36,"button",17),e.bIt("click",function(){return i.getrideData()}),e.EFF(37,"Apply Filter"),e.k0s(),e.j41(38,"button",18),e.bIt("click",function(){return i.clearFilter()}),e.EFF(39,"Clear Filter"),e.k0s()()(),e.j41(40,"div",19)(41,"div",20)(42,"div",21)(43,"table",22)(44,"thead",23)(45,"tr")(46,"th")(47,"pre"),e.EFF(48,"Req. ID"),e.k0s()(),e.j41(49,"th")(50,"pre"),e.EFF(51,"Pick up Time"),e.k0s()(),e.j41(52,"th")(53,"pre"),e.EFF(54,"Pick up Address"),e.k0s()(),e.j41(55,"th")(56,"pre"),e.EFF(57,"Delivery Address"),e.k0s()(),e.j41(58,"th")(59,"pre"),e.EFF(60,"Service Type"),e.k0s()(),e.j41(61,"th")(62,"pre"),e.EFF(63,"Status"),e.k0s()(),e.j41(64,"th")(65,"pre"),e.EFF(66,"Search"),e.k0s()(),e.j41(67,"th")(68,"pre"),e.EFF(69,"Action"),e.k0s()()()(),e.j41(70,"tbody"),e.DNE(71,H,36,19,"tr",24),e.nI1(72,"paginate"),e.k0s()()()()(),e.j41(73,"div",25)(74,"pagination-controls",26),e.bIt("pageChange",function(o){return i.onPageChange(o)}),e.k0s()()),2&s&&(e.R7$(2),e.Y8G("ngModel",i.statusfilter),e.R7$(3),e.Y8G("value",0),e.R7$(2),e.Y8G("value",1),e.R7$(2),e.Y8G("value",2),e.R7$(2),e.Y8G("ngModel",i.vehiclefilter),e.R7$(3),e.Y8G("ngForOf",i.filteredVehicles),e.R7$(1),e.Y8G("ngModel",i.searchText),e.R7$(1),e.Y8G("ngModel",i.searchDate),e.R7$(4),e.Y8G("ngModel",i.limit),e.R7$(9),e.Y8G("ngModel",i.sortOrder),e.R7$(42),e.Y8G("ngForOf",e.i5U(72,13,i.ridesArray,e.sMw(16,Q,i.limit,i.currentPage,i.count))),e.R7$(3),e.Y8G("maxSize",5)("responsive",!0))},dependencies:[p.YU,p.Sq,p.bT,p.ux,p.e1,p.fG,l.xH,l.y7,l.me,l.wz,l.BC,l.vS,f.ej,m.An,h.kk,h.fb,h.Cp,g.$z,f.kf],styles:[".parentFormContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;text-align:center;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}#tableContainer[_ngcontent-%COMP%]{background-color:#0000001f;border-radius:10px;box-shadow:2px 2px 2px #000;width:90%;padding:20px;margin:40px}pre[_ngcontent-%COMP%]{font-size:13px;font-weight:900;color:#000}.statusbadge[_ngcontent-%COMP%]{font-size:14px;padding:5px;border-radius:3px;font-weight:900}.badge-success[_ngcontent-%COMP%]{background-color:#49b600;color:#fff}.badge-info[_ngcontent-%COMP%]{background-color:#c200b8;color:#fff}.badge-warning[_ngcontent-%COMP%]{background-color:#e46600;color:#fff}.badge-danger[_ngcontent-%COMP%]{background-color:#e42200;color:#fff}.badge-light[_ngcontent-%COMP%]{background-color:#fff;color:#000}.infobadge[_ngcontent-%COMP%]{box-shadow:inset 2px 2px 4px 2px #6d62fa;border:none;font-size:16px;color:#000;font-weight:700}.fixed-width[_ngcontent-%COMP%]{width:100px}.container[_ngcontent-%COMP%]{margin:0 auto;padding:20px}.filter-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-bottom:20px}#filter-dropdown[_ngcontent-%COMP%], #pageSize[_ngcontent-%COMP%]{padding:5px}#search-input[_ngcontent-%COMP%]{flex-grow:1;padding:5px}#search-button[_ngcontent-%COMP%]{padding:10px 15px;background-color:#2196f3;color:#fff;border:none;cursor:pointer}#searchbtn[_ngcontent-%COMP%]{padding:6px;background-color:#7200c4;color:#fff;border:none;cursor:pointer;border-radius:3px}#filterbtn[_ngcontent-%COMP%]{padding:6px;background-color:#06c300;color:#fff;border:none;cursor:pointer;border-radius:3px}#clearbtn[_ngcontent-%COMP%]{padding:6px;background-color:#bf0000;color:#fff;border:none;cursor:pointer;border-radius:3px}"]})}}return n})();var te=c(8498);const ne=[{path:"",component:ee,pathMatch:"full"}];let ie=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[p.MD,te.iI.forChild(ne),l.YN,l.X1,f.ed,m.m_,h.Cn,g.Hl]})}}return n})()}}]);